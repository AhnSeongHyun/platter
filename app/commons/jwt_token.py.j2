import jwt


class TokenInfo(object):

    def __init__(self, email: str, user_name: str):
        self.email = email
        self.user_name = user_name

    def to_dict(self) -> dict:
        return vars(self)


def create_token(token_info: TokenInfo) -> str:
    if isinstance(token_info, TokenInfo):
        return jwt.encode(token_info.to_dict(), '{{app}}', algorithm='HS256')


def parse_token(token: str):
    return jwt.decode(token, '{{app}}', algorithm='HS256')

